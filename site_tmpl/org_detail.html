{% extends 'base_admin.html' %}

{% block extrajs %}
    $(document).ready(function () {
        $('.collapse').collapse('hide');
    });
{% endblock %}


{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="jumbotron">
                 <h1>{{org }}</h1>
                 {% if org.shortname %}
                 ({{ org.shortname }})
                 {% endif %}
                 <a class="btn btn-lg btn-primary" href="{% url "events.views.orgs.addeditorgs" org.id %}">Edit</a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <h3>Contact</h3>
            <table>
                <tr>
                    <th>Address</th>
                    <td>{{org.address}}</td>
                </tr>
                <tr>
                    <th>Phone</th>
                    <td>{{ org.phone }}</td>
                </tr>
                <tr>
                    <th>Exec Email </th>
                    <td><a href="mailto:{{ org.exec_email }}">{{ org.exec_email }}</a></td>
                </tr>
                <tr>
                    <th>Club Email </th>
                    <td><a href="mailto:{{ org.email }}"> {{ org.email }}</a> </td>
                </tr>
                <tr>
                    <th>User in charge </th>
                    <td> {{ org.user_in_charge }} </td>
                </tr>
            
            </table>
        </div>
        <div class="col-md-3">
            <h3>Money</h3>
            <table>
                {% for f in org.accounts.all %}
                <tr><td>
                    <b><a href="{% url 'admin-fundedit' f.id %}">{{ f }}</a></b>
                    {% if f.notes %}{{ f.notes }}{% endif %}
                </td></tr>
                {% endfor %}
                <tr><td>
                    <b><a href="{% url 'admin-fundaddorg' org.id %}">[Add New]</a></b>
                </td></tr>
                <tr>
                    <td colspan="2">
                        {% if org.verifications.exists %}
                        <p class="muted text-muted">
                        Last verified by: {{ org.verifications.latest.verified_by }} on {{ org.verifications.latest.date }}
                        </p>

                        {% else %}
                        <p class="muted text-muted">No verification created</p>
                        {% endif %}
                        <a href="{% url "admin-org-verify" org.id %}">Create Verification</a>
                    </td>
                </tr>
                
            </table>
        </div>
        <div class="col-md-3">
            <h3>Associated Users</h3>
            <ul class="list-unstyled">
                {% for u in org.associated_users.all %}
                    <li>{{ u }}</li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-3">
            <h3>Associated Orgs</h3>
            <ul class="list-unstyled">
                {% for o in org.associated_orgs.all %}
                <li><a href="{% url "admin-orgdetail" o.id %}">{{o}}</a></li>
                {% empty %}
                <li>No Associated Orgs</li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
        <h3>Events</h3>
        <table class="table table-compact">
            <thead>
                <th>
                    Event Name
                </th>
                <th>
                    Date Ended
                </th>
                <th>
                    Location
                </th>
                <th>
                    Services
                </th>
                <th>
                    Status
                </th>
            </thead>
            {% for e in org.event_set.all %}
            <tr>
                <td>
                    <a href="{% url "events.views.flow.viewevent" e.id %}">{{ e }}</a>
                </td>
                <td>
                    {{ e.datetime_end }}
                </td>
                <td>
                    {{ e.location }}
                </td>
                <td>
                    {% for s in e.allservices %}
                    <i class="{{ s.i }}" title="{{s.title}}"></i>
                    {% endfor %}
                </td>
                <td>
                    {{ e.status }}
                </td>
            </tr>
            {% endfor %}
        </table>
        </div>
    </div>
{% endblock %}